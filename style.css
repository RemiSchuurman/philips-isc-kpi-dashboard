:root {
  --bg: #edf3fa;
  --bg-grad-a: #f7fbff;
  --bg-grad-b: #e7f0fb;
  --card: #ffffff;
  --text: #0c1f3f;
  --muted: #50617d;
  --primary: #00629b;
  --primary-strong: #005189;
  --primary-soft: #e8f3fb;
  --success: #24a148;
  --warning: #ef8f20;
  --danger: #da1e28;
  --border: #d6e2f1;
  --shadow-soft: 0 10px 26px rgba(0, 57, 112, 0.08);
  --shadow-focus: 0 12px 30px rgba(0, 98, 155, 0.22);
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  font-family: "Segoe UI", "Inter", Arial, sans-serif;
  background: var(--bg);
  background-image: radial-gradient(circle at 18% 0%, var(--bg-grad-a), transparent 43%),
    radial-gradient(circle at 90% 9%, var(--bg-grad-b), transparent 40%);
  color: var(--text);
}

.app-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
  padding: 1rem 1.5rem 1.1rem;
  background: rgba(255, 255, 255, 0.93);
  border-bottom: 1px solid rgba(214, 226, 241, 0.95);
  position: sticky;
  top: 0;
  z-index: 10;
  backdrop-filter: blur(10px);
}

.app-header::before {
  content: "";
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 4px;
  background: linear-gradient(90deg, #00629b 0%, #0a85c8 55%, #29a9e0 100%);
}

.app-header h1 {
  margin: 0;
  font-size: 1.12rem;
  letter-spacing: 0.2px;
}

.header-left {
  display: grid;
  gap: 0.42rem;
}

.brand-strip {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.34rem 0.62rem;
  width: fit-content;
  border-radius: 999px;
  border: 1px solid #c4d8eb;
  background: linear-gradient(180deg, #f4f9fe 0%, #edf5fc 100%);
}

.philips-logo {
  display: block;
  width: 52px;
  height: auto;
}

.brand-separator {
  width: 1px;
  height: 14px;
  background: #bdd2e6;
}

.brand-label {
  font-size: 0.72rem;
  font-weight: 700;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  color: #275984;
}

.sub-title {
  margin: 0.25rem 0 0;
  color: var(--muted);
  font-size: 0.88rem;
}

.header-meta {
  display: flex;
  flex-direction: column;
  align-items: flex-end;
  font-weight: 700;
  color: var(--primary);
  gap: 0.35rem;
}

.layout {
  display: grid;
  grid-template-columns: 280px 1fr;
  gap: 1.1rem;
  padding: 1.2rem 1.5rem 2rem;
}

.stream-panel,
.dashboard-panel {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 1.1rem;
  box-shadow: var(--shadow-soft);
}

.stream-panel h2 {
  margin: 0 0 0.6rem;
  font-size: 0.95rem;
  text-transform: uppercase;
  color: var(--muted);
  letter-spacing: 0.08em;
}

.stream-list {
  list-style: none;
  padding: 0;
  margin: 0;
  display: grid;
  gap: 0.5rem;
}

.scope-toggle {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 0.4rem;
  margin-bottom: 0.75rem;
}

.scope-btn {
  border: 1px solid #c8dbec;
  background: #f2f8fd;
  color: #205384;
  border-radius: 999px;
  padding: 0.34rem 0.55rem;
  font-size: 0.74rem;
  font-weight: 700;
  cursor: pointer;
}

.scope-btn.active {
  background: var(--primary);
  color: #fff;
  border-color: var(--primary);
}

.stream-btn {
  width: 100%;
  text-align: left;
  padding: 0.7rem 0.8rem;
  border-radius: 10px;
  border: 1px solid var(--border);
  background: linear-gradient(180deg, #ffffff 0%, #f4f9ff 100%);
  cursor: pointer;
  color: var(--text);
  font-weight: 650;
  transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease, background 0.2s ease;
}

.stream-btn:hover {
  transform: translateY(-1px);
  border-color: #bfd4e9;
  box-shadow: 0 8px 18px rgba(0, 98, 155, 0.14);
}

.stream-btn.active {
  border-color: #73a8ce;
  background: linear-gradient(180deg, #eff7fd 0%, #e1f1fb 100%);
  color: #0a2f53;
  box-shadow: var(--shadow-focus);
}

.empty-state {
  color: var(--muted);
  padding: 1.1rem 0.6rem;
  border: 1px dashed var(--border);
  border-radius: 10px;
  background: #fafcff;
}

.hidden {
  display: none;
}

.kpi-container {
  display: grid;
  gap: 0.8rem;
}

details.kpi-group {
  border: 1px solid var(--border);
  border-radius: 12px;
  overflow: hidden;
  background: #ffffff;
  transition: box-shadow 0.28s ease, border-color 0.28s ease;
}

details.kpi-group:hover {
  border-color: #bcd4e9;
}

details.kpi-group[open] {
  box-shadow: var(--shadow-soft);
  border-color: #9fc1de;
}

details.kpi-group > summary {
  list-style: none;
  cursor: pointer;
  padding: 0.78rem 0.9rem;
  font-weight: 700;
  background: linear-gradient(180deg, #f8fbff 0%, #f0f7fd 100%);
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.8rem;
  transition: background 0.24s ease;
}

details.kpi-group > summary::-webkit-details-marker {
  display: none;
}

.kpi-title {
  font-size: 0.96rem;
}

.kpi-summary-meta {
  display: inline-flex;
  align-items: center;
  gap: 0.45rem;
}

.kpi-status-pill {
  display: inline-flex;
  align-items: center;
  gap: 0.35rem;
  font-size: 0.76rem;
  line-height: 1;
  padding: 0.3rem 0.52rem;
  border-radius: 999px;
  border: 1px solid transparent;
  font-weight: 700;
  color: #2f4869;
  background: #edf4fb;
}

.kpi-status-dot {
  width: 7px;
  height: 7px;
  border-radius: 50%;
  background: #a6b2c8;
}

.kpi-status-pill.green {
  background: #ebf9ef;
  color: #207a3f;
  border-color: #c8ecd3;
}

.kpi-status-pill.green .kpi-status-dot {
  background: var(--success);
}

.kpi-status-pill.yellow {
  background: #fff5e8;
  color: #aa6310;
  border-color: #f7ddbb;
}

.kpi-status-pill.yellow .kpi-status-dot {
  background: var(--warning);
}

.kpi-status-pill.red {
  background: #ffecef;
  color: #a8222a;
  border-color: #f5c6cc;
}

.kpi-status-pill.red .kpi-status-dot {
  background: var(--danger);
}

.kpi-summary-action {
  color: #4e6787;
  font-size: 0.78rem;
  padding: 0.3rem 0.5rem;
  border-radius: 8px;
  border: 1px solid #cfe0f1;
  background: #f3f8fd;
}

details.kpi-group[open] .kpi-summary-action {
  color: #17456f;
  border-color: #9cc1df;
  background: #e4f1fb;
}

.kpi-content {
  padding: 0.8rem 0.95rem 0.95rem;
  transform-origin: top center;
}

details.kpi-group[open] .kpi-content {
  animation: kpi-reveal 0.46s cubic-bezier(0.22, 0.61, 0.36, 1);
}

@keyframes kpi-reveal {
  from {
    opacity: 0;
    transform: translateY(-8px) scaleY(0.985);
  }

  to {
    opacity: 1;
    transform: translateY(0) scaleY(1);
  }
}

.kpi-list {
  margin: 0;
  padding-left: 1.05rem;
  color: var(--text);
  line-height: 1.5;
}

.kpi-list li {
  margin-bottom: 0.35rem;
}

.kpi-section-title {
  margin: 0 0 0.55rem;
  font-size: 0.84rem;
  letter-spacing: 0.03em;
  text-transform: uppercase;
  color: #55627b;
  font-weight: 700;
}

.fillrate-chart {
  margin-bottom: 0.95rem;
  padding: 0.65rem;
  border: 1px solid #d8e5f3;
  border-radius: 10px;
  background: #f9fcff;
}

.fillrate-bars {
  display: grid;
  grid-template-columns: repeat(13, minmax(20px, 1fr));
  align-items: end;
  gap: 0.35rem;
  min-height: 110px;
}

.fillrate-bar-item {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 0.3rem;
}

.fillrate-bar {
  width: 100%;
  min-width: 12px;
  border-radius: 6px 6px 3px 3px;
  border: 1px solid transparent;
}

.fillrate-bar.ok {
  background: linear-gradient(180deg, #bceec9 0%, #56c271 100%);
  border-color: #9ad8ad;
}

.fillrate-bar.risk {
  background: linear-gradient(180deg, #ffc9cf 0%, #f15f6d 100%);
  border-color: #e8929b;
}

.fillrate-bar-label {
  font-size: 0.67rem;
  color: #5e6b83;
}

.kpi-table-wrap {
  margin-top: 0.9rem;
  overflow-x: auto;
}

.kpi-matrix-table,
.kpi-action-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.82rem;
  background: #fff;
  border: 1px solid #d8e5f3;
  border-radius: 10px;
  overflow: hidden;
}

.kpi-matrix-table th,
.kpi-matrix-table td,
.kpi-action-table th,
.kpi-action-table td {
  border-bottom: 1px solid #edf1f9;
  padding: 0.42rem 0.52rem;
  text-align: center;
  white-space: nowrap;
}

.kpi-matrix-table thead th,
.kpi-action-table thead th {
  background: #eef5fc;
  color: #39587a;
  font-weight: 700;
  position: sticky;
  top: 0;
}

.kpi-matrix-table th[scope="row"],
.kpi-action-table td:first-child,
.kpi-action-table th:first-child {
  text-align: left;
}

.kpi-matrix-table .is-total-row th,
.kpi-matrix-table .is-total-row td {
  font-weight: 700;
  background: #f3f8fd;
}

.value-good {
  color: #176f37;
  font-weight: 700;
}

.value-warn {
  color: #a35c08;
  font-weight: 700;
}

.value-bad {
  color: #a8222a;
  font-weight: 700;
}

.kpi-controls-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.8rem;
  flex-wrap: wrap;
}

.kpi-controls {
  display: inline-flex;
  align-items: center;
  gap: 0.55rem;
}

.mode-label {
  font-size: 0.78rem;
  color: #5b6981;
  font-weight: 600;
}

.mode-toggle-btn {
  border: 1px solid #b9d2e8;
  background: #edf5fc;
  color: #205384;
  border-radius: 999px;
  padding: 0.28rem 0.62rem;
  font-size: 0.77rem;
  font-weight: 700;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease, background 0.2s ease;
}

.mode-toggle-btn:hover {
  transform: translateY(-1px);
  border-color: #91b8d7;
  box-shadow: 0 8px 18px rgba(0, 98, 155, 0.14);
}

.mode-toggle-btn.active {
  border-color: var(--primary);
  color: #fff;
  background: var(--primary);
}

.primary-btn,
.ghost-btn {
  border-radius: 10px;
  padding: 0.44rem 0.72rem;
  font-size: 0.78rem;
  font-weight: 700;
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.primary-btn {
  border: 1px solid var(--primary);
  background: linear-gradient(180deg, #0a79b9 0%, #00629b 100%);
  color: #fff;
}

.primary-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 8px 18px rgba(0, 98, 155, 0.2);
}

.ghost-btn {
  border: 1px solid #c8dbec;
  background: #f2f8fd;
  color: #215283;
}

.ghost-btn:hover {
  transform: translateY(-1px);
}

.modal {
  position: fixed;
  inset: 0;
  background: rgba(7, 25, 51, 0.46);
  display: grid;
  place-items: center;
  z-index: 40;
  padding: 1rem;
}

.modal-card {
  width: min(920px, 100%);
  max-height: 90vh;
  overflow-y: auto;
  background: #fff;
  border: 1px solid #cddff0;
  border-radius: 14px;
  box-shadow: 0 20px 50px rgba(7, 25, 51, 0.26);
  padding: 1rem;
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.8rem;
  margin-bottom: 0.4rem;
}

.modal-header h2 {
  margin: 0;
  font-size: 1.05rem;
}

.step-indicator {
  margin-bottom: 0.65rem;
}

#stepBadge {
  display: inline-block;
  border: 1px solid #bfd4e8;
  background: #edf5fc;
  color: #1f4f7e;
  border-radius: 999px;
  padding: 0.25rem 0.55rem;
  font-size: 0.75rem;
  font-weight: 700;
}

.upload-step h3 {
  margin: 0.2rem 0 0.45rem;
}

.upload-step p {
  margin: 0.2rem 0 0.6rem;
  color: #4b5d7b;
}

.upload-step label {
  display: block;
  margin-top: 0.55rem;
  margin-bottom: 0.2rem;
  font-size: 0.8rem;
  font-weight: 700;
  color: #2f4668;
}

.upload-step input[type="text"],
.upload-step input[type="file"] {
  width: 100%;
  border: 1px solid #c9dbee;
  border-radius: 10px;
  padding: 0.48rem 0.55rem;
  background: #fff;
}

.step-actions {
  display: flex;
  justify-content: flex-end;
  gap: 0.5rem;
  margin-top: 0.75rem;
}

.validation-summary {
  margin-top: 0.65rem;
  font-size: 0.82rem;
  border-radius: 10px;
  padding: 0.5rem 0.6rem;
  border: 1px solid #d3dfef;
  background: #f5f9ff;
  color: #32567f;
}

.validation-summary.success {
  border-color: #bfe5cb;
  background: #effaf3;
  color: #1f703a;
}

.validation-summary.error {
  border-color: #f0c7cc;
  background: #fff1f3;
  color: #9f232b;
}

.preview-container {
  margin-top: 0.7rem;
}

.upload-result {
  margin-top: 0.6rem;
  font-size: 0.85rem;
  font-weight: 700;
  color: #2e5278;
}

.upload-result.success {
  color: #1e6f3a;
}

.upload-result.error {
  color: #a1222a;
}

.status {
  font-weight: 700;
}

.status.green {
  color: var(--success);
}

.status.yellow {
  color: var(--warning);
}

.status.red {
  color: var(--danger);
}

.context-grid {
  margin-top: 1.1rem;
  display: grid;
  grid-template-columns: repeat(3, minmax(0, 1fr));
  gap: 0.8rem;
}

.context-card {
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 0.9rem;
  background: linear-gradient(180deg, #ffffff 0%, #f9fbff 100%);
  box-shadow: 0 6px 18px rgba(14, 26, 45, 0.06);
}

.context-card h3 {
  margin: 0 0 0.5rem;
  font-size: 0.92rem;
  letter-spacing: 0.04em;
  text-transform: uppercase;
  color: #4a5872;
}

.context-card ul {
  margin: 0;
  padding-left: 1rem;
  line-height: 1.45;
}

@media (max-width: 980px) {
  .app-header {
    align-items: flex-start;
  }

  .header-left {
    width: 100%;
  }

  .brand-strip {
    width: 100%;
    justify-content: flex-start;
  }

  .layout {
    grid-template-columns: 1fr;
  }

  .header-meta {
    align-items: flex-start;
  }

  .context-grid {
    grid-template-columns: 1fr;
  }

  .scope-toggle {
    grid-template-columns: 1fr;
  }

  .header-meta {
    width: 100%;
    align-items: flex-start;
  }

  #openUploadBtn {
    width: 100%;
  }
}
